# ENVIRONMENT

append_path() {
  case ":$PATH:" in
    *:"$1":*) ;;
    *) PATH="${PATH:+$PATH:}$1"
  esac
}

clean_path() {
  PATH="$(printf "${PATH//:/\\n}" | awk '!visited[$0]++' | tr '\n' ':' | sed 's/:$//')"
}

clean_path

[[ ! -v ANDROID_HOME ]] &&
  export ANDROID_HOME='/opt/android-sdk'
[[ ! -v ANDROID_SDK_ROOT ]] &&
  export ANDROID_SDK_ROOT="$ANDROID_HOME"

append_path "$ANDROID_HOME/cmdline-tools/latest/bin"
append_path "$ANDROID_HOME/platform-tools"
append_path "$HOME/.cargo/bin"
append_path "$HOME/.config/composer/vendor/bin"
append_path "$HOME/.go/bin"
append_path "$HOME/.npm/bin"
append_path "$HOME/.perl5/bin"

export PATH

export INTERNAL_AUDIO_SINK=$(pactl list sources | awk '/\.monitor/ { print $2 }')

export GOPATH="$HOME/.go"
export NPM_CONFIG_PREFIX="$HOME/.npm"
export PERL5LIB="$HOME/.perl5"
export LESS="-IFRS --incsearch --mouse --no-histdups --use-color"

# INTERACTIVE

[[ $- != *i* ]] && return

source ~/.local/share/omarchy/default/bash/rc
source ~/.aliases
[[ -f /usr/share/bash-preexec/bash-preexec.sh ]] &&
  source /usr/share/bash-preexec/bash-preexec.sh

# OPTIONS

set -o vi
shopt -s autocd
shopt -s direxpand
shopt -s dirspell
shopt -s globstar
shopt -s histreedit
shopt -s histverify
shopt -s no_empty_cmd_completion

HISTCONTROL=ignoredups:erasedups

# SHELL FUNCTIONS

precmd() {
  history -a
  history -c
  history -r
}

# SHELL TOOLS

cmds="
"

for cmd in $cmds; do
  if command -v $(cut -d ' ' -f 1) >/dev/null; then
    source <(cmd)
  fi
done
